<!--profile页面-->
<view class="profile-container">
  
  <!-- Loading界面 -->
  <view class="loading-container" wx:if="{{isLoading}}">
    <view class="loading-content">
      <view class="loading-spinner">
        <view class="spinner"></view>
      </view>
      <text class="loading-text">正在加载用户信息...</text>
    </view>
  </view>
  
  <!-- 主要内容 -->
  <view class="main-content" wx:else>
    <!-- 用户信息卡片 -->
    <view class="user-card" bind:tap="onUserCardTap">
      <view class="avatar-section">
        <image 
          src="{{userInfo.avatarUrl || defaultAvatar}}" 
          class="user-avatar"
        />
      </view>
      
      <view class="user-info">
        <view class="user-name-section">
          <text class="user-name">{{userInfo.nickName || '威朗普'}}</text>
        </view>
      </view>
    </view>

    <!-- 统计数据 -->
    <view class="stats-section">
      <view class="section-title">
        <text class="title-text">我的发布</text>
      </view>
      
      <view class="stats-grid">
        <view class="stat-item">
          <view class="stat-icon">📝</view>
          <text class="stat-number">{{stats.postsCount}}</text>
          <text class="stat-label">发布条数</text>
        </view>
        <view class="stat-item">
          <view class="stat-icon">📷</view>
          <text class="stat-number">{{stats.imagesCount}}</text>
          <text class="stat-label">图片数量</text>
        </view>
        <view class="stat-item">
          <view class="stat-icon">✍️</view>
          <text class="stat-number">{{stats.totalWords}}</text>
          <text class="stat-label">文字数量</text>
        </view>
      </view>
    </view>

    <!-- 订阅与推送 -->
    <view class="stats-section">
      <view class="section-title">
        <text class="title-text">订阅提醒</text>
      </view>
      
      <!-- 订阅次数显示（可点击） -->
      <view 
        class="subscribe-count-display" 
        bind:tap="onSubscribeAndStartPush"
        bindlongpress="onSubscribeCountLongPress"
      >
        <text class="count-label">当前订阅次数：</text>
        <text class="count-number">{{subscribeCount}}</text>
      </view>
    </view>
  </view>

  <!-- 清空订阅次数弹窗 -->
  <t-popup 
    visible="{{showClearSubscribePopup}}" 
    bind:visible-change="onClearSubscribePopupVisibleChange"
    placement="bottom"
    class="clear-subscribe-popup"
  >
    <view class="clear-subscribe-content">
      <view class="clear-subscribe-header">
        <text class="clear-subscribe-title">清空订阅次数</text>
        <view class="clear-subscribe-close" bind:tap="cancelClearSubscribe">×</view>
      </view>
      
      <view class="clear-subscribe-form">
        <view class="clear-subscribe-tip">确认删除所有订阅次数吗？</view>
      </view>
      
      <view class="clear-subscribe-actions">
        <view 
          class="clear-subscribe-reset-native"
          bindtap="cancelClearSubscribe"
        >
          <text class="button-text">取消</text>
        </view>
        <view 
          class="clear-subscribe-submit-native"
          bindtap="confirmClearSubscribe"
        >
          <text class="button-text">清空</text>
        </view>
      </view>
    </view>
  </t-popup>
</view>